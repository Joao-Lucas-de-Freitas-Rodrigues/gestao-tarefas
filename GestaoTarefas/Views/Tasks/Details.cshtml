@model GestaoTarefas.Models.TaskItem
@using GestaoTarefas.Models.Enums

<h3>@Model.Title</h3>
<p class="text-muted">@Model.Description</p>

<ul class="list-unstyled">
    <li><strong>Status:</strong> @Model.Status</li>
    <li><strong>Prioridade:</strong> @Model.Priority</li>
    <li><strong>Categoria:</strong> @Model.Category?.Name</li>
    <li><strong>Vencimento:</strong> @(Model.DueDateUtc?.ToLocalTime().ToString("dd/MM/yyyy"))</li>
</ul>

<h5 class="mt-4">Subtarefas</h5>
@if (Model.Subtasks?.Any() == true)
{
    <ul class="list-group">
        @foreach (var s in Model.Subtasks.OrderBy(x => x.SortOrder))
        {
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <form asp-action="ToggleSub" method="post"
                      class="m-0 w-100 d-flex justify-content-between align-items-center">
                    @Html.AntiForgeryToken()
                    <input type="hidden" name="id" value="@s.Id" />

                    <div>
                        <input type="checkbox"
                               @(s.IsCompleted ? "checked" : "")
                               onchange="this.form.submit();" />
                        <span class="ms-2 @(s.IsCompleted ? "text-decoration-line-through text-muted" : "")">
                            @s.Title
                        </span>
                    </div>
                </form>
            </li>
        }
    </ul>
}
else
{
    <p class="text-muted">Sem subtarefas.</p>
}

<div class="mt-3">
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">Editar</a>
    <a asp-action="Index" class="btn btn-secondary">Voltar</a>
</div>
